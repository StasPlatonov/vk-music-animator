let defaultSettingsBg={visType:"frequencybars",theme:"vktheme",useOpacity:!0,minFreq:20,maxFreq:15e3};var settings;function logStorage(){chrome.storage?chrome.storage.local.get(function(e){console.log("chrome.storage.local:"),chrome.runtime.lastError?console.error(chrome.runtime.lastError):console.log(e.settings)}):console.warn("chrome.storage is not accessible, check permissions")}async function getCurrentTabId(){var[e]=await chrome.tabs.query({active:!0,currentWindow:!0});return e.id}chrome.storage.sync.get({settings:defaultSettingsBg},function(e){settings=e.settings}),chrome.runtime.onMessage.addListener((e,t,n)=>"query-active-tab"===e.action?(chrome.tabs.query({active:!0},e=>{0<e.length&&n({id:e[0].id})}),!0):"get-settings"===e.action?(chrome.storage.sync.get({settings:defaultSettingsBg},function(e){settings=e.settings,n(e.settings)}),!0):"set-settings"===e.action?(chrome.storage.sync.set({settings:e.settings},function(){n()}),!0):void 0),chrome.runtime.onInstalled.addListener(e=>{e.reason===chrome.runtime.OnInstalledReason.INSTALL&&(console.log("Reload all vk.com tabs on install extension"),chrome.tabs.query({url:"*://vk.com/*"}).then(function(e){e.forEach(function(e){chrome.tabs.reload(e.id)})}))});